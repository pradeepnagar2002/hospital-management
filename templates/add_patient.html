<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ 'Edit' if edit else 'Add' }} Patient</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <h2>{{ 'Edit Patient' if edit else 'Add New Patient' }}</h2>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% for category, message in messages %}
            <div class="alert alert-{{ category }}">{{ message }}</div>
          {% endfor %}
        {% endwith %}

        <form method="POST" enctype="multipart/form-data">
            <label>Name:</label>
            <input name="name" value="{{ patient.name if edit else '' }}" required pattern="[A-Za-z ]+">

            <label>Date of Birth:</label>
            <input name="dob" type="date" value="{{ patient.dob if edit else '' }}" required>

            <label>Age:</label>
            <input name="age" type="number" min="1" max="120" value="{{ patient.age if edit else '' }}">

            <label>Gender:</label>
            <select name="gender">
                <option value="M" {% if edit and patient.gender == 'M' %}selected{% endif %}>Male</option>
                <option value="F" {% if edit and patient.gender == 'F' %}selected{% endif %}>Female</option>
                <option value="O" {% if edit and patient.gender == 'O' %}selected{% endif %}>Other</option>
            </select>

            <label>Contact:</label>
            <input name="contact" value="{{ patient.contact if edit else '' }}" pattern="\d{10}" required>

            <label>Address:</label>
            <input name="address" value="{{ patient.address if edit else '' }}" required>

            <label>Emergency Contact:</label>
            <input name="emergency" value="{{ patient.emergency_contact if edit else '' }}" pattern="\d{10}">

            <label>Blood Group:</label>
            <input name="blood" value="{{ patient.blood_group if edit else '' }}" pattern="^(A|B|AB|O)[+-]$" required>

            <label>Diagnosis:</label>
            <input name="diagnosis" value="{{ patient.diagnosis if edit else '' }}" required>

            <label>Admit Date:</label>
            <input name="admit" type="date" value="{{ patient.admit_date if edit else '' }}">

            <label>Discharge Date:</label>
            <input name="discharge" type="date" value="{{ patient.discharge_date if edit else '' }}">

            <label>Medical Report (PDF):</label>
            <input type="file" name="report" accept=".pdf">

            <button type="submit">{{ 'Update' if edit else 'Add' }} Patient</button>
        </form>

        <a href="/">&larr; Back to Patient List</a>
    </div>
</body>
</html>